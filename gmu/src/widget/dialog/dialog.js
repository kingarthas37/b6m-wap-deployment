!function(t,e,i){var n={close:'<a class="ui-dialog-close" title="关闭"><span class="ui-icon ui-icon-delete"></span></a>',mask:'<div class="ui-mask"></div>',title:'<div class="ui-dialog-title"><h3><%=title%></h3></div>',wrap:'<div class="ui-dialog"><div class="ui-dialog-content"></div><% if(btns){ %><div class="ui-dialog-btns"><% for(var i=0, length=btns.length; i<length; i++){var item = btns[i]; %><a class="ui-btn ui-btn-<%=item.index%>" data-key="<%=item.key%>"><%=item.text%></a><% } %></div><% } %></div> '};t.define("Dialog",{options:{autoOpen:!0,buttons:null,closeBtn:!0,mask:!0,width:300,height:"auto",title:null,content:null,scrollMove:!0,container:null,maskClick:null,position:null},getWrap:function(){return this._options._wrap},_init:function(){var t,i=this,o=i._options,s=0,a=e.proxy(i._eventHandler,i),l={};i.on("ready",function(){o._container=e(o.container||document.body),(o._cIsBody=o._container.is("body"))||o._container.addClass("ui-dialog-container"),l.btns=t=[],o.buttons&&e.each(o.buttons,function(e){t.push({index:++s,text:e,key:e})}),o._mask=o.mask?e(n.mask).appendTo(o._container):null,o._wrap=e(e.parseTpl(n.wrap,l)).appendTo(o._container),o._content=e(".ui-dialog-content",o._wrap),o._title=e(n.title),o._close=o.closeBtn&&e(n.close).highlight("ui-dialog-close-hover"),i.$el=i.$el||o._content,i.title(o.title),i.content(o.content),t.length&&e(".ui-dialog-btns .ui-btn",o._wrap).highlight("ui-state-hover"),o._wrap.css({width:o.width,height:o.height}),e(window).on("ortchange",a),o._wrap.on("click",a),o._mask&&o._mask.on("click",a),o.autoOpen&&i.open()})},_create:function(){var t=this._options;this._options.setup&&(t.content=t.content||this.$el.show(),t.title=t.title||this.$el.attr("title"))},_eventHandler:function(t){var i,n,o,s=this,a=s._options;switch(t.type){case"ortchange":this.refresh();break;case"touchmove":a.scrollMove&&t.preventDefault();break;case"click":if(a._mask&&(e.contains(a._mask[0],t.target)||a._mask[0]===t.target))return s.trigger("maskClick");n=a._wrap.get(0),(i=e(t.target).closest(".ui-dialog-close",n))&&i.length?s.close():(i=e(t.target).closest(".ui-dialog-btns .ui-btn",n))&&i.length&&(o=a.buttons[i.attr("data-key")],o&&o.apply(s,arguments))}},_calculate:function(){var t,i,n=this,o=n._options,s=document.body,a={},l=o._cIsBody,c=Math.round;return o.mask&&(a.mask=l?{width:"100%",height:Math.max(s.scrollHeight,s.clientHeight)-1}:{width:"100%",height:"100%"}),t=o._wrap.offset(),i=e(window),a.wrap={left:"50%",marginLeft:-c(t.width/2)+"px",top:l?c(i.height()/2)+window.pageYOffset:"50%",marginTop:-c(t.height/2)+"px"},a},refresh:function(){var t,i,n=this,o=n._options;return o._isOpen&&(i=function(){t=n._calculate(),t.mask&&o._mask.css(t.mask),o._wrap.css(t.wrap)},e.os.ios&&document.activeElement&&/input|textarea|select/i.test(document.activeElement.tagName)?(document.body.scrollLeft=0,setTimeout(i,200)):i()),n},open:function(t,n){var o=this._options;return o._isOpen=!0,o._wrap.css("display","block"),o._mask&&o._mask.css("display","block"),t!==i&&this.position?this.position(t,n):this.refresh(),e(document).on("touchmove",e.proxy(this._eventHandler,this)),this.trigger("open")},close:function(){var t,i=this._options;return t=e.Event("beforeClose"),this.trigger(t),t.defaultPrevented?this:(i._isOpen=!1,i._wrap.css("display","none"),i._mask&&i._mask.css("display","none"),e(document).off("touchmove",this._eventHandler),this.trigger("close"))},title:function(t){var e=this._options,n=t!==i;return n&&(t=(e.title=t)?"<h3>"+t+"</h3>":t,e._title.html(t)[t?"prependTo":"remove"](e._wrap),e._close&&e._close.prependTo(e.title?e._title:e._wrap)),n?this:e.title},content:function(t){var e=this._options,n=t!==i;return n&&e._content.empty().append(e.content=t),n?this:e.content},destroy:function(){var t=this._options,i=this._eventHandler;return e(window).off("ortchange",i),e(document).off("touchmove",i),t._wrap.off("click",i).remove(),t._mask&&t._mask.off("click",i).remove(),t._close&&t._close.highlight(),this.$super("destroy")}})}(gmu,gmu.$);