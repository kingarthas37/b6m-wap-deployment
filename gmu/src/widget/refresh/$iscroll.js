!function(e,t){e.Refresh.register("iscroll",{_init:function(){var e=this,o=e._options,l=e.$el,r=l.height();t.extend(o,{useTransition:!0,speedScale:1,topOffset:o.$upElem?o.$upElem.height():0}),o.threshold=o.threshold||5,l.wrapAll(t('<div class="ui-refresh-wrapper"></div>').height(r)).css("height","auto"),e.on("ready",function(){e._loadIscroll()})},_changeStyle:function(e,t){var o=this,l=o._options,r=l.refreshInfo[e];switch(o.origin(e,t),t){case"loaded":r.$icon.addClass("ui-refresh-icon");break;case"beforeload":r.$label.html("松开立即加载"),r.$icon.addClass("ui-refresh-flip");break;case"loading":r.$icon.removeClass().addClass("ui-loading")}return o},_loadIscroll:function(){var e=this,o=e._options,l=o.threshold;o.iScroll=new iScroll(e.$el.parent().get(0),o.iScrollOpts=t.extend({useTransition:o.useTransition,speedScale:o.speedScale,topOffset:o.topOffset},o.iScrollOpts,{onScrollStart:function(t){e.trigger("scrollstart",t)},onScrollMove:function(){var t=o.$upElem&&o.$upElem.length,r=o.$downElem&&o.$downElem.length;return function(s){var i=o._upRefreshed,n=o._downRefreshed,a=e._status("up"),c=e._status("down");t&&!a||r&&!c||this.maxScrollY>=0||(c&&r&&!n&&this.y<this.maxScrollY-l?e._setMoveState("down","beforeload","pull"):a&&t&&!i&&this.y>l?(e._setMoveState("up","beforeload","pull"),this.minScrollY=0):c&&n&&this.y>this.maxScrollY+l?e._setMoveState("down","loaded","restore"):a&&i&&this.y<l&&(e._setMoveState("up","loaded","restore"),this.minScrollY=-o.topOffset),e.trigger("scrollmove",s))}}(),onScrollEnd:function(t){var l=o._actDir;l&&e._status(l)&&(e._setStyle(l,"loading"),e._loadingAction(l,"pull")),e.trigger("scrollend",t)}}))},_setMoveState:function(e,t,o){var l=this,r=l._options;return l._setStyle(e,t),r["_"+e+"Refreshed"]="pull"==o,r._actDir="pull"==o?e:"",l},afterDataLoading:function(e){var t=this,o=t._options,e=e||o._actDir;return o.iScroll.refresh(),o["_"+e+"Refreshed"]=!1,t.origin(e)}})}(gmu,gmu.$);