!function(e,n){var t=n.fx.cssPrefix,s=n.fx.transitionEnd;e.define("Panel",{options:{contentWrap:"",scrollMode:"follow",display:"push",position:"right",dismissible:!0,swipeClose:!0},_init:function(){var e=this,t=e._options;e.on("ready",function(){e.displayFn=e._setDisplay(),e.$contentWrap.addClass("ui-panel-animate"),e.$el.on(s,n.proxy(e._eventHandler,e)).hide(),t.dismissible&&e.$panelMask.hide().on("click",n.proxy(e._eventHandler,e)),"follow"!==t.scrollMode&&n(window).on("scrollStop",n.proxy(e._eventHandler,e)),n(window).on("ortchange",n.proxy(e._eventHandler,e))})},_create:function(){if(!this._options.setup)throw new Error("panel组件不支持create模式，请使用setup模式");var e=this,t=e._options,s=e.$el.addClass("ui-panel ui-panel-"+t.position);e.panelWidth=s.width()||0,e.$contentWrap=n(t.contentWrap||s.next()),t.dismissible&&(e.$panelMask=n('<div class="ui-panel-dismiss"></div>').width(document.body.clientWidth-s.width()).appendTo("body")||null)},_setDisplay:function(){var e,s,o=this,i=o.$el,a=o.$contentWrap,l=t+"transform",r=o._transDisplayToPos(),p={};return n.each(["push","overlay","reveal"],function(n,t){p[t]=function(n,p,c){return e=r[t].panel,s=r[t].cont,i.css(l,"translate3d("+o._transDirectionToPos(p,e[n])+"px,0,0)"),c||(a.css(l,"translate3d("+o._transDirectionToPos(p,s[n])+"px,0,0)"),o.maskTimer=setTimeout(function(){o.$panelMask&&o.$panelMask.css(p,i.width()).toggle(n)},400)),o}}),p},_initPanelPos:function(e,n){return this.displayFn[e](0,n,!0),this.$el.get(0).clientLeft,this},_transDirectionToPos:function(e,n){return"left"===e?n:-n},_transDisplayToPos:function(){var e=this,n=e.panelWidth;return{push:{panel:[-n,0],cont:[0,n]},overlay:{panel:[-n,0],cont:[0,0]},reveal:{panel:[0,0],cont:[0,n]}}},_setShow:function(e,t,s){var o=this,i=o._options,a=e?"open":"close",l=n.Event("before"+a),r=e!==o.state(),p=e?"on":"off",c=e?n.proxy(o._eventHandler,o):o._eventHandler,d=t||i.display,u=s||i.position;return o.trigger(l,[t,s]),l.isDefaultPrevented()?o:(r&&(o._dealState(e,d,u),o.displayFn[d](o.isOpen=Number(e),u),i.swipeClose&&o.$el[p](n.camelCase("swipe-"+u),c),i.display=d,i.position=u),o)},_dealState:function(e,t,o){var i=this,a=i._options,l=i.$el,r=i.$contentWrap,p="ui-panel-"+t+" ui-panel-"+o,c="ui-panel-"+a.display+" ui-panel-"+a.position+" ui-panel-animate";return e&&(l.removeClass(c).addClass(p).show(),"fix"===a.scrollMode&&l.css("top",n(window).scrollTop()),i._initPanelPos(t,o),"reveal"===t?r.addClass("ui-panel-contentWrap").on(s,n.proxy(i._eventHandler,i)):(r.removeClass("ui-panel-contentWrap").off(s,n.proxy(i._eventHandler,i)),l.addClass("ui-panel-animate")),i.$panelMask&&i.$panelMask.css({left:"auto",right:"auto",height:document.body.clientHeight})),i},_eventHandler:function(e){var t=this,o=t._options,i=o.scrollMode,a=t.state()?"open":"close";switch(e.type){case"click":case"swipeLeft":case"swipeRight":t.close();break;case"scrollStop":"fix"===i?t.$el.css("top",n(window).scrollTop()):t.close();break;case s:t.trigger(a,[o.display,o.position]);break;case"ortchange":t.$panelMask&&t.$panelMask.css("height",document.body.clientHeight),"fix"===i&&t.$el.css("top",n(window).scrollTop())}},open:function(e,n){return this._setShow(!0,e,n)},close:function(){return this._setShow(!1)},toggle:function(e,n){return this[this.isOpen?"close":"open"](e,n)},state:function(){return!!this.isOpen},destroy:function(){return this.$panelMask&&this.$panelMask.off().remove(),this.maskTimer&&clearTimeout(this.maskTimer),this.$contentWrap.removeClass("ui-panel-animate"),n(window).off("scrollStop",this._eventHandler),n(window).off("ortchange",this._eventHandler),this.$super("destroy")}})}(gmu,gmu.$);